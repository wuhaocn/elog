# ebpf log
## mqtt log
* build
```
make
```
* run
```
sudo ./bin/tc enp0s1
```
* log
```
2024/04/02 15:33:36 Src addr        Port   -> Dest addr       Port   CurTime         SRtt   NetProto NetCmd          NetPLen AppProto   AppCmd     AppPLen PlayLoad  
2024/04/02 15:33:42 192.168.64.5    46214  -> 54.244.173.190  1883   39034393304099  0      TCP      SYN             0       MQTT       N          0       00 00 00 00 00 
2024/04/02 15:33:42 54.244.173.190  1883   -> 192.168.64.5    46214  39034564547922  171    TCP      SYN, ACK        0       MQTT       N          0       00 00 00 00 00 
2024/04/02 15:33:42 192.168.64.5    46214  -> 54.244.173.190  1883   39034564638462  0      TCP      ACK             0       MQTT       N          0       00 00 00 00 00 
2024/04/02 15:33:42 192.168.64.5    46214  -> 54.244.173.190  1883   39034565182076  0      TCP      ACK, PSH        43      MQTT       CONNECT    41      10 29 00 00 00 
2024/04/02 15:33:43 54.244.173.190  1883   -> 192.168.64.5    46214  39034732428779  167    TCP      ACK             0       MQTT       N          0       00 00 00 00 00 
2024/04/02 15:33:43 54.244.173.190  1883   -> 192.168.64.5    46214  39034923765881  358    TCP      ACK, PSH        4       MQTT       CONNACK    2       20 02 00 00 00 
2024/04/02 15:33:43 192.168.64.5    46214  -> 54.244.173.190  1883   39034923828380  0      TCP      ACK             0       MQTT       N          0       00 00 00 00 00 
2024/04/02 15:33:43 192.168.64.5    46214  -> 54.244.173.190  1883   39034924223747  0      TCP      ACK, PSH        20      MQTT       SUBSCRIBE  18      82 12 00 00 00 
2024/04/02 15:33:43 192.168.64.5    46214  -> 54.244.173.190  1883   39034924373702  0      TCP      ACK, FIN, PSH   19      MQTT       N          17      33 11 00 00 00 
2024/04/02 15:33:43 54.244.173.190  1883   -> 192.168.64.5    46214  39035093557376  169    TCP      ACK             0       MQTT       N          0       00 00 00 00 00 
2024/04/02 15:33:43 54.244.173.190  1883   -> 192.168.64.5    46214  39035093653624  169    TCP      ACK, FIN        0       MQTT       N          0       00 00 00 00 00 
2024/04/02 15:33:43 192.168.64.5    46214  -> 54.244.173.190  1883   39035093681249  169    TCP      ACK             0       MQTT       N          0       00 00 00 00 00 
```
